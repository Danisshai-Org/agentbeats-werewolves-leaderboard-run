[
  {
    "name": "Full History",
    "query": "SELECT CASE s.unnest.player_name WHEN 'Player_1' THEN results.participants.Player_1 WHEN 'Player_2' THEN results.participants.Player_2 WHEN 'Player_3' THEN results.participants.Player_3 WHEN 'Player_4' THEN results.participants.Player_4 WHEN 'Player_5' THEN results.participants.Player_5 END AS id, COUNT(*) AS \"Games\", ROUND(AVG(s.unnest.metrics.aggregate_score) * 100, 1) AS \"Avg Score\", ROUND(SUM(CASE WHEN s.unnest.won THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) AS \"Win %\", ROUND(AVG(s.unnest.metrics.deception_score) * 100, 1) AS \"Deception\", ROUND(AVG(s.unnest.metrics.detection_score) * 100, 1) AS \"Detection\" FROM results CROSS JOIN UNNEST(results.results) AS r(unnest) CROSS JOIN UNNEST(r.unnest.scores) AS s(unnest) GROUP BY id ORDER BY \"Avg Score\" DESC"
  },
  {
    "name": "Werewolf Ranking",
    "query": "SELECT CASE s.unnest.player_name WHEN 'Player_1' THEN results.participants.Player_1 WHEN 'Player_2' THEN results.participants.Player_2 WHEN 'Player_3' THEN results.participants.Player_3 WHEN 'Player_4' THEN results.participants.Player_4 WHEN 'Player_5' THEN results.participants.Player_5 END AS id, COUNT(*) AS \"Games as Wolf\", SUM(CASE WHEN s.unnest.won THEN 1 ELSE 0 END) AS \"Wins\", ROUND(SUM(CASE WHEN s.unnest.won THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) AS \"Win %\", ROUND(AVG(s.unnest.metrics.deception_score) * 100, 1) AS \"Deception\" FROM results CROSS JOIN UNNEST(results.results) AS r(unnest) CROSS JOIN UNNEST(r.unnest.scores) AS s(unnest) WHERE s.unnest.role = 'werewolf' GROUP BY id ORDER BY \"Win %\" DESC"
  },
  {
    "name": "Villager Ranking",
    "query": "SELECT CASE s.unnest.player_name WHEN 'Player_1' THEN results.participants.Player_1 WHEN 'Player_2' THEN results.participants.Player_2 WHEN 'Player_3' THEN results.participants.Player_3 WHEN 'Player_4' THEN results.participants.Player_4 WHEN 'Player_5' THEN results.participants.Player_5 END AS id, COUNT(*) AS \"Games as Villager\", SUM(CASE WHEN s.unnest.won THEN 1 ELSE 0 END) AS \"Wins\", ROUND(SUM(CASE WHEN s.unnest.won THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 1) AS \"Win %\", ROUND(AVG(s.unnest.metrics.detection_score) * 100, 1) AS \"Detection\" FROM results CROSS JOIN UNNEST(results.results) AS r(unnest) CROSS JOIN UNNEST(r.unnest.scores) AS s(unnest) WHERE s.unnest.team = 'villagers' GROUP BY id ORDER BY \"Win %\" DESC"
  },
  {
    "name": "Game History",
    "query": "SELECT results.participants.Player_1 AS id, r.unnest.winner AS \"Winner\", r.unnest.rounds_played AS \"Rounds\" FROM results CROSS JOIN UNNEST(results.results) AS r(unnest) WHERE r.unnest.scores IS NOT NULL ORDER BY \"Rounds\" DESC"
  }
]
